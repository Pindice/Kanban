{% extends "tableau/base.html" %}

{% load static %}

{% block content %}
<head>
</head>
<body>
  <div id="myKanban"></div>

  <script>
    var board = new jKanban({
      element: '#myKanban',
      gutter: '10px',
      widthBoard: '250px',
      dragBoards: false,
      dragItems: true,
      boards: [
        {
          id: 'todo',
          title: 'To Do',
          item: [
            {
              title: 'Task 1',
              description: 'This is the first task.',
              id: 'task1'
            },
            {
              title: 'Task 2',
              description: 'This is the second task.',
              id: 'task2'
            }
          ]
        },
        {
          id: 'inprogress',
          title: 'In Progress',
          item: [
            {
              title: 'Task 3',
              description: 'This is the third task.',
              id: 'task3'
            }
          ]
        },
        {
          id: 'done',
          title: 'Done',
          item: [
            {
              title: 'Task 4',
              description: 'This is the fourth task.',
              id: 'task4'
            }
          ]
        }
      ]
    });

    $("#submitBtn").click(function() {
      var data = [];
      var boards = board.getBoardElements();
      for (var i = 0; i < boards.length; i++) {
        var boardData = {
          nom_col: boards[i].title,
          tasks: []
        };
        for (var j = 0; j < boards[i].item.length; j++) {
          var taskData = {
            nom_task: boards[i].item[j].title
          };
          boardData.tasks.push(taskData);
        }
        data.push(boardData);
      }
      $.ajax({
        type: "POST",
        url: "/update_data/",
        data: JSON.stringify(data),
        dataType: "json",
        contentType: "application/json",
        success: function(response) {
          console.log(response);
        },
        error: function(xhr) {
          console.log(xhr.responseText);
        }
      });
    });
  </script>
</body>
</html>
{% endblock %}

